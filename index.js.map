{"version":3,"file":"index.js","sources":["src/router.jsx"],"sourcesContent":["import React from 'react'\n\nconst getDisplayName = Component => `router(${\n  Component.displayName\n  || Component.name\n  || (Component.constructor && Component.constructor.name)\n  || 'Unknown'\n})`\n\nconst isRouteFound = title => result => result && [].concat(title).includes(result.title)\n\nconst hoc = (title, options) => Component => class extends React.Component {\n  static displayName = getDisplayName(Component)\n\n  static contextTypes = {\n    store: () => null, // this is to avoid importing prop-types\n  }\n\n  constructor(props, context) {\n    super(props, context)\n\n    this.state = { show: false }\n  }\n\n  componentWillMount() {\n    // subscribe\n    this.unsubscribe = this.context.store.subscribe(() => {\n      this.toShow()\n    })\n\n    // run in once\n    this.toShow()\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe()\n  }\n\n  toShow = () => {\n    const state = this.context.store.getState()\n\n    if (!state.router || !state.router.result) {\n      // eslint-disable-next-line no-console\n      console.error('/HOC/ Router | There is no route found in `state.router.result`')\n      return\n    }\n\n    // Absolute mode, we are looking in top level only\n    let result = state.router.result\n    if (options && options.absolute) {\n      const show = isRouteFound(title)(result)\n      if (show !== this.state.show) {\n        this.setState(innerState => ({ ...innerState, show }))\n      }\n\n      return\n    }\n\n    // Either way we are looking top down the result tree\n    let show = isRouteFound(title)(result)\n    while (result && !show) {\n      result = result.parent\n      show = isRouteFound(title)(result)\n    }\n\n    if (show !== this.state.show) {\n      this.setState(innerState => ({ ...innerState, show }))\n    }\n  }\n\n  render() {\n    if (!this.state.show) return null\n\n    return <Component {...this.props} />\n  }\n}\n\nhoc.absolute = (title, options) => hoc(title, { ...options, absolute: true })\n\nexport default hoc\n"],"names":["isRouteFound","result","concat","title","includes","hoc","options","props","context","toShow","state","_this","store","getState","router","absolute","show","setState","innerState","parent","error","React","Component","unsubscribe","this","subscribe","displayName","name","constructor","getDisplayName","contextTypes"],"mappings":"+6BASMA,EAAe,mBAAS,mBAAUC,MAAaC,OAAOC,GAAOC,SAASH,EAAOE,SAE7EE,EAAM,SAACF,EAAOG,UAAY,sDAOlBC,EAAOC,4EACXD,EAAOC,aAmBfC,OAAS,eACDC,EAAQC,EAAKH,QAAQI,MAAMC,cAE5BH,EAAMI,QAAWJ,EAAMI,OAAOb,YAO/BA,EAASS,EAAMI,OAAOb,UACtBK,GAAWA,EAAQS,cACfC,EAAOhB,EAAaG,EAAbH,CAAoBC,GAC7Be,IAASL,EAAKD,MAAMM,QACjBC,SAAS,wBAAoBC,GAAYF,wBAO9CA,EAAOhB,EAAaG,EAAbH,CAAoBC,GACxBA,IAAWe,KACPf,EAAOkB,SACTnB,EAAaG,EAAbH,CAAoBC,GAGzBe,IAASL,EAAKD,MAAMM,QACjBC,SAAS,wBAAoBC,GAAYF,yBAvBtCI,MAAM,sEAtBXV,OAAUM,MAAM,wUAVkCK,EAAMC,2EAexDC,YAAcC,KAAKhB,QAAQI,MAAMa,UAAU,aACzChB,gBAIFA,6DAIAc,sDAoCAC,KAAKd,MAAMM,KAETK,gBAACC,EAAcE,KAAKjB,OAFE,gBA3DxBmB,YAVc,6BACrBJ,EAAUI,aACPJ,EAAUK,MACTL,EAAUM,aAAeN,EAAUM,YAAYD,MAChD,eAMkBE,CAAeP,KAE7BQ,oBACE,kBAAM,kBA8DjBzB,EAAIU,SAAW,SAACZ,EAAOG,UAAYD,EAAIF,OAAYG,GAASS,UAAU"}